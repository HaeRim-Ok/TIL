# Persistent Volume, Persistent Volume Claim

persistent volume과 persistent volume claim의 관계

![image](https://user-images.githubusercontent.com/77096463/112401413-d4602100-8d4d-11eb-925a-56177502dcf1.png)

<br>

매니페스트 파일(persistentVolume.yml) 실행

```yaml
apiVersion: v1
kind : PersistentVolume
metadata:
 name: pv0001
 labels:
  type: local
spec: 
 capacity: 
  storage: 2Gi
 accessModes:
  - ReadWriteOnce
 hostPath:
  path: "/data001/pv0001"
```

```
[root@master ~]# kubectl apply -f persistentVolume.yml 
persistentvolume/pv0001 created
```

<br>

매니페스트 파일(persistentVolumeClaim.yml) 실행

```yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
 name: my-volumeclaim
spec:
 accessModes:
  - ReadWriteOnce
 resources:
  requests:
   storage: 1Gi
 selector:
  matchLabels:
   type: local
```

```
[root@master ~]# kubectl apply -f persistentVolumeClaim.yml 
persistentvolumeclaim/my-volumeclaim created
```

<br>

마운트 확인

```
[root@master ~]# kubectl get pv
NAME     CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                    STORAGECLASS   REASON   AGE
pv0001   2Gi        RWO            Retain           Bound    default/my-volumeclaim                           10m

[root@master ~]# kubectl get pvc
NAME             STATUS   VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS   AGE
my-volumeclaim   Bound    pv0001   2Gi        RWO                           116s
```

<br>

매니페스트 파일 (pod.yml) 생성 -> 볼륨마운트 안 걸려있는 파일

```yaml
apiVersion: v1
kind: Pod
metadata:
 name: my-user-app
 labels:
  app: my-user-app
spec:
 containers:
 - name: my-user-ms
   image: edowon0623/my-user-service:1.1
   ports:
     - containerPort: 8088
```

